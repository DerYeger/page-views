import{_ as f,g as v,r as g,h as y,o as i,c as s,t as m}from"../app.1ca369dc.js";function l(e){return`eu.yeger.page-views.${e}`}const S={backendUrl:"https://page-views.up.railway.app/api/views",filter:()=>!0,throttle:864e5,trackPopState:!1};function r(e){return{...S,...e}}function h(){if(typeof window>"u"||typeof window.location>"u")return;const e=window.location,t=`${e.host}${e.pathname}`;return t.endsWith("/")?t.substring(0,t.length-1):t}async function c(e={},t){const n=t!=null?t:h();if(!n)return;const{backendUrl:o,filter:a,throttle:u}=r(e);if(a(n)){if(u&&typeof localStorage<"u"){const p=Date.now(),w=localStorage.getItem(l(n));if(w!==null&&+w+u>p)return;localStorage.setItem(l(n),p.toString())}try{await fetch(`${o}/${n}`,{method:"POST"})}catch{}}}async function E(e={},t){const n=t!=null?t:h();if(!n)return 0;const{backendUrl:o}=r(e);return+await(await fetch(`${o}/${n}`,{method:"GET"})).text()}let d=!1;function k(e={}){if(typeof window>"u"||typeof history>"u"||d)return;d=!0;const t=r(e);(()=>{const n=history.pushState;history.pushState=function(...o){const a=n.apply(this,o);return window.dispatchEvent(new Event("pushstate")),window.dispatchEvent(new Event("locationchange")),a},t.trackPopState&&window.addEventListener("popstate",()=>{window.dispatchEvent(new Event("locationchange"))})})(),window.addEventListener("locationchange",()=>{c(t)}),c(t)}const _={autoSubmitViews:k,getViews:E,submitView:c};const b={class:"page-views"},V={key:0},$={key:1},x=v({__name:"ViewCounter",setup(e){const t=g();return _.autoSubmitViews(),y(async()=>{t.value=await _.getViews()}),(n,o)=>(i(),s("div",b,[t.value===void 0?(i(),s("span",V,"Loading...")):(i(),s("span",$,m(t.value)+" views",1))]))}});var I=f(x,[["__scopeId","data-v-2ddd6184"]]);export{I as _};
